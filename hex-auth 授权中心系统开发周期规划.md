# hex-auth 授权中心系统开发周期规划

## 1. 项目概述

hex-auth 是一个 **统一在线授权中心**，为 GUI / CLI / Service / Plugin 等多形态程序提供 **在线激活、心跳校验、授权吊销与后台管理** 能力。

## 2. 开发周期总览

| 阶段 | 时间周期 | 主要任务 |
|------|----------|----------|
| 阶段1：需求分析与技术准备 | 2天 | 需求细化、技术选型确认、环境搭建 |
| 阶段2：数据库与缓存设计实现 | 2天 | 数据库表结构设计、Redis缓存设计、数据迁移脚本编写 |
| 阶段3：后端核心功能开发 | 6天 | Admin Module开发、License API开发、安全机制实现 |
| 阶段4：前端UI开发 | 6天 | 页面设计、组件开发、交互实现 |
| 阶段5：集成测试与调试 | 3天 | 前后端集成、功能测试、性能测试 |
| 阶段6：部署与上线准备 | 1天 | 部署文档编写、环境配置、上线准备 |
| **总计** | **20天** | - |

## 3. 阶段详细规划

### 3.1 阶段1：需求分析与技术准备（2天）

#### 3.1.1 任务列表

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| 需求细化与确认 | 产品经理 | 0.5天 | 需求文档 |
| 技术选型最终确认 | 技术负责人 | 0.5天 | 技术方案文档 |
| 开发环境搭建 | 开发团队 | 1天 | 环境配置文档 |
| 项目结构设计 | 架构师 | 1天 | 项目结构文档 |

#### 3.1.2 关键事项

- 确认产品需求和技术架构
- 搭建开发、测试环境
- 制定编码规范和开发流程
- 初始化项目代码仓库

### 3.2 阶段2：数据库与缓存设计实现（2天）

#### 3.2.1 任务列表

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| 数据库表结构设计 | 数据库工程师 | 1天 | 数据库设计文档 |
| Redis缓存设计 | 后端开发 | 0.5天 | 缓存设计文档 |
| 数据迁移脚本编写 | 后端开发 | 0.5天 | Alembic迁移脚本 |
| 数据库初始化 | 数据库工程师 | 0.5天 | 初始化脚本 |
| 缓存服务搭建 | 后端开发 | 0.5天 | 缓存配置文档 |

#### 3.2.2 关键事项

- 实现5个核心表设计：products、licenses、clients、admin_users、audit_logs
- 设计Redis缓存策略，用于授权信息和心跳状态缓存
- 确保数据库表结构符合产品/授权/实例强隔离原则
- 建立数据迁移机制，支持后续架构演进

#### 3.2.3 核心设计要点

- 每个产品拥有独立RSA密钥对，存储在products表
- License与Product强绑定，支持限制最大实例数
- Client与License强绑定，记录客户端指纹和心跳状态
- AuditLog记录所有关键管理操作，支持可追溯性
- Redis缓存活跃客户端信息，提高心跳校验性能

### 3.3 阶段3：后端核心功能开发（6天）

#### 3.3.1 核心领域模型开发（1天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| Product模型开发 | 后端开发 | 0.2天 | Product模型代码 |
| License模型开发 | 后端开发 | 0.2天 | License模型代码 |
| Client模型开发 | 后端开发 | 0.2天 | Client模型代码 |
| AdminUser模型开发 | 后端开发 | 0.2天 | AdminUser模型代码 |
| AuditLog模型开发 | 后端开发 | 0.2天 | AuditLog模型代码 |

#### 3.3.2 Admin Module开发（2天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| Admin API认证机制 | 后端开发 | 0.5天 | JWT认证代码 |
| 产品管理API开发 | 后端开发 | 0.5天 | 产品管理API代码 |
| 授权管理API开发 | 后端开发 | 0.5天 | 授权管理API代码 |
| 实例管理API开发 | 后端开发 | 0.5天 | 实例管理API代码 |
| 审计日志API开发 | 后端开发 | 0.5天 | 审计日志API代码 |
| 管理员管理API开发 | 后端开发 | 0.5天 | 管理员管理API代码 |

#### 3.3.3 License API开发（2天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| 授权激活API开发 | 后端开发 | 0.7天 | 激活API代码 |
| 心跳校验API开发 | 后端开发 | 0.7天 | 心跳API代码 |
| 授权状态API开发 | 后端开发 | 0.6天 | 状态API代码 |

#### 3.3.4 安全机制实现（1天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| RSA非对称加密实现 | 后端开发 | 0.5天 | RSA工具类代码 |
| License Token生成与验证 | 后端开发 | 0.3天 | Token处理代码 |
| 心跳机制实现 | 后端开发 | 0.2天 | 心跳服务代码 |
| 授权吊销逻辑 | 后端开发 | 0.2天 | 吊销服务代码 |

#### 3.3.5 关键事项

- 确保授权逻辑全部在服务端实现
- 实现Admin API与License API物理隔离
- 确保客户端仅存公钥，不存密钥
- 所有授权行为可审计、可追溯
- 实现激活与校验解耦

### 3.4 阶段4：前端UI开发（6天）

#### 3.4.1 页面设计与组件开发（3天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| Dashboard页面开发 | 前端开发 | 0.5天 | Dashboard组件 |
| Products页面开发 | 前端开发 | 1天 | Products组件 |
| Licenses页面开发 | 前端开发 | 1天 | Licenses组件 |
| Clients页面开发 | 前端开发 | 0.5天 | Clients组件 |
| Audit Logs页面开发 | 前端开发 | 0.5天 | AuditLogs组件 |

#### 3.4.2 交互实现与API对接（2天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| API接口封装 | 前端开发 | 0.5天 | API封装代码 |
| 页面交互逻辑实现 | 前端开发 | 1天 | 交互逻辑代码 |
| 前后端联调 | 前后端开发 | 0.5天 | 联调测试报告 |

#### 3.4.3 UI优化与测试（1天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| UI样式优化 | 前端开发 | 0.5天 | 优化后的UI |
| 前端测试 | 前端开发 | 0.5天 | 前端测试报告 |

#### 3.4.4 关键事项

- 实现冷色/深色主题设计
- 确保高信息密度布局
- 遵循Vue 3 + Naive UI最佳实践
- 实现响应式设计，支持多种设备

### 3.5 阶段5：集成测试与调试（3天）

#### 3.5.1 功能测试（2天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| 授权激活流程测试 | 测试工程师 | 0.5天 | 激活测试报告 |
| 心跳机制测试 | 测试工程师 | 0.5天 | 心跳测试报告 |
| 授权吊销测试 | 测试工程师 | 0.5天 | 吊销测试报告 |
| 管理后台功能测试 | 测试工程师 | 0.5天 | 管理后台测试报告 |
| 安全机制测试 | 测试工程师 | 0.5天 | 安全测试报告 |
| 缓存机制测试 | 测试工程师 | 0.5天 | 缓存测试报告 |

#### 3.5.2 性能测试与优化（1天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| API性能测试 | 测试工程师 | 0.5天 | 性能测试报告 |
| 系统负载测试 | 测试工程师 | 0.5天 | 负载测试报告 |
| Redis缓存性能测试 | 测试工程师 | 0.5天 | 缓存性能报告 |
| 性能优化 | 开发团队 | 0.5天 | 优化后的代码 |

#### 3.5.3 关键事项

- 测试覆盖所有核心功能点
- 验证授权逻辑全部在服务端实现
- 测试RSA非对称加密机制的安全性
- 验证心跳机制的可靠性
- 确保审计日志完整记录所有关键操作

### 3.6 阶段6：部署与上线准备（1天）

| 任务 | 负责人 | 时间 | 交付物 |
|------|--------|------|--------|
| 部署文档编写 | 技术负责人 | 0.5天 | 部署文档 |
| 生产环境配置 | 运维工程师 | 0.5天 | 环境配置脚本 |
| 数据库与缓存部署 | 运维工程师 | 0.5天 | 数据库缓存配置 |
| 后端服务部署 | 后端开发 | 0.5天 | 后端部署脚本 |
| 前端应用部署 | 前端开发 | 0.5天 | 前端部署脚本 |
| 上线准备检查 | 项目负责人 | 0.5天 | 上线检查清单 |

#### 3.6.1 关键事项

- 确保生产环境安全配置到位
- 验证数据库与缓存连接正常
- 确保前后端服务正常运行
- 准备应急回滚方案
- 制定监控策略

## 4. 里程碑与交付物

| 里程碑 | 交付物 | 完成时间 |
|--------|--------|----------|
| 项目启动 | 需求文档、技术方案文档 | 第2天 |
| 数据库与缓存设计完成 | 数据库设计文档、缓存设计文档、迁移脚本 | 第4天 |
| 后端核心功能完成 | 后端代码、API文档、安全机制实现 | 第10天 |
| 前端UI开发完成 | 前端代码、UI组件、交互逻辑 | 第16天 |
| 系统测试完成 | 测试报告、优化后的代码、性能测试报告 | 第19天 |
| 上线准备完成 | 部署文档、环境配置、上线检查清单 | 第20天 |

## 5. 风险与应对措施

| 风险 | 应对措施 |
|------|----------|
| 需求变更 | 建立变更控制流程，严格评估变更影响 |
| 技术难点 | 提前进行技术调研和原型验证 |
| 开发延期 | 合理安排任务，预留缓冲时间 |
| 测试不充分 | 制定详细的测试计划，覆盖所有功能点 |
| Redis缓存失效 | 设计合理的缓存策略，实现缓存自动重建机制 |
| RSA密钥管理风险 | 建立严格的密钥管理流程，定期轮换密钥 |
| 数据库性能瓶颈 | 优化数据库设计，建立索引，使用Redis缓存缓解压力 |
| 前后端集成问题 | 提前定义API接口规范，进行接口模拟测试 |

## 6. 资源需求

| 角色 | 人数 | 职责 |
|------|------|------|
| 产品经理 | 1 | 需求分析、产品设计 |
| 技术负责人 | 1 | 技术架构设计、团队管理 |
| 后端开发 | 2 | 后端API开发、核心业务逻辑实现、安全机制实现、缓存设计 |
| 前端开发 | 1 | 前端UI开发、交互实现、API对接 |
| 测试工程师 | 1 | 功能测试、性能测试、安全测试、缓存测试 |
| 运维工程师 | 1 | 环境搭建、部署配置、数据库与缓存管理 |
| **总计** | **7人** | - |

## 7. 开发流程与规范

- **开发模式**：敏捷开发，每日站会，每周迭代
- **代码管理**：Git + GitHub/GitLab
- **分支策略**：主分支 + 开发分支 + 功能分支
- **代码审查**：Pull Request + 代码审查
- **测试策略**：单元测试 + 集成测试 + 功能测试
- **文档规范**：Markdown格式，及时更新

## 8. 预期成果

- 完整的hex-auth授权中心系统
- 详细的开发文档、测试文档和部署文档
- 稳定可靠的授权服务
- 易用的管理后台
- 良好的扩展性和可维护性

## 9. 后续演进规划

- 多管理员角色（RBAC）
- 授权策略插件化
- 离线授权（独立模块）
- 客户端 SDK 标准化
- SaaS 化部署
